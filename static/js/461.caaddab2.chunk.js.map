{"version":3,"file":"static/js/461.caaddab2.chunk.js","mappings":"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","sources":["cluster-utils.js","keyword-worker.js","../webpack/bootstrap","../webpack/runtime/amd define","../webpack/runtime/amd options","../webpack/runtime/chunk loaded","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/node module decorator","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import { calculateTfIdf } from \"ts-tfidf\";\nimport { Cluster } from \"ml-hclust\";\nimport { mean } from \"mathjs\";\n\nexport function extractKeywordsTfIdf(tokens, clusters, { nKeywords = 10 } = {}) {\n  const corpus = calculateTfIdf({\n    texts: tokens.map((t) => t.join(\" \")),\n    stopWords: [\"null\"],\n  });\n  const clusterIds = getIdsPerCluster(clusters);\n\n  // average tfidf for each cluster\n  const words = Array.from(corpus[0].keys());\n  const clusterTfidf = clusterIds.map((ids) =>\n    mean(\n      ids.map((i) => Array.from(corpus[i].values())),\n      0\n    )\n  );\n\n  // get the top nKeywords keywords for each cluster\n  const clusterKeywords = clusterTfidf.map((ct) => {\n    const sorted = ct.map((t, i) => [i, t]).sort((a, b) => b[1] - a[1]);\n    return sorted.slice(0, nKeywords).map((t) => words[t[0]]);\n  });\n\n  // join keywords per cluster\n  const keywords = clusterKeywords.map((kw) => kw.join(\",\"));\n  console.log(keywords);\n  return keywords;\n}\n\nexport function extractAgnesClusters(tree, nClusters, nObjects) {\n  tree = toCluster(tree);\n  const groups = tree.group(parseInt(nClusters));\n  let clusts = Array(nObjects).fill(-1);\n  for (let cli = 0; cli < nClusters; ++cli) {\n    let ch = groups.children[cli];\n    for (const chi of ch.indices()) {\n      clusts[chi] = cli;\n    }\n  }\n\n  return clusts;\n}\n\nexport function getIdsPerCluster(clusters) {\n  let clusterIds = Array(new Set(clusters).size)\n    .fill()\n    .map(() => []);\n  for (let i = 0; i < clusters.length; ++i) {\n    clusterIds[clusters[i]].push(i);\n  }\n  return clusterIds;\n}\n\nfunction toCluster(tree) {\n  const cluster = new Cluster();\n  cluster.height = tree.height;\n  cluster.size = tree.size;\n  cluster.index = tree.index;\n  cluster.isLeaf = tree.isLeaf;\n  cluster.children = tree.children.map(toCluster);\n  return cluster;\n}\n","import { extractKeywordsTfIdf, extractAgnesClusters } from \"./cluster-utils.js\";\n\nonmessage = function (event) {\n  const tree = event.data.tree;\n  const nClusters = event.data.nClusters;\n  const embedding = event.data.embedding;\n  const tokens = event.data.tokens;\n\n  postMessage({ text: \"Worker started!\", type: \"update\" });\n  const clusts = extractAgnesClusters(tree, nClusters, embedding.length);\n  postMessage({ text: \"Clusters estimated!\", type: \"update\" });\n  const keywords = extractKeywordsTfIdf(tokens, clusts, { nKeywords: 5 });\n  postMessage({ text: \"Keywords extracted!\", type: \"update\" });\n\n  postMessage({ clusts: clusts, keywords: keywords, type: \"result\" });\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [232], function() { return __webpack_require__(7570); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"1049645f\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t461: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkvisual_search\"] = self[\"webpackChunkvisual_search\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(232).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["extractKeywordsTfIdf","tokens","clusters","_ref$nKeywords","arguments","length","undefined","nKeywords","corpus","calculateTfIdf","texts","map","t","join","stopWords","clusterIds","Array","Set","size","fill","i","push","getIdsPerCluster","words","from","keys","keywords","ids","mean","values","ct","sort","a","b","slice","kw","console","log","toCluster","tree","cluster","Cluster","height","index","isLeaf","children","onmessage","event","data","nClusters","embedding","postMessage","text","type","clusts","nObjects","groups","group","parseInt","cli","_step","ch","_iterator","_createForOfIteratorHelper","indices","s","n","done","value","err","e","f","extractAgnesClusters","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","id","loaded","__webpack_modules__","call","m","x","__webpack_exports__","O","amdD","Error","amdO","deferred","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","every","key","splice","r","getter","__esModule","d","definition","o","defineProperty","enumerable","get","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","nmd","paths","p","installedChunks","importScripts","chunkLoadingGlobal","self","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}